<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhang185a.gitee.io","root":"/blog/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Zhang185&#39;s blog">
<meta property="og:url" content="http://zhang185a.gitee.io/blog/page/2/index.html">
<meta property="og:site_name" content="Zhang185&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://zhang185a.gitee.io/blog/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Zhang185's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Zhang185's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A17/" class="post-title-link" itemprop="url">2021杭电多校7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-13 23:20:37" itemprop="dateCreated datePublished" datetime="2021-08-13T23:20:37+08:00">2021-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-18 23:52:43" itemprop="dateModified" datetime="2021-08-18T23:52:43+08:00">2021-08-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Fall-with-Trees"><a href="#Fall-with-Trees" class="headerlink" title="Fall with Trees"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7046" target="_blank" rel="noopener">Fall with Trees</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给一颗深度为k的完全二叉树，满足一下几个条件：每个节点的x坐标是其所有子节点的平均值；每层的y坐标相同；相邻的两层的y坐标差值相同。求这个二叉树的面积。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>快速幂+直接计算或者用开vector+push_back的话会T，不知道是不是测评机赛后慢的原因</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gtldink9byj60qa0s4ad602.jpg" alt="image-20210818234649770"></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">double</span> two[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        two[i] = cur;</span><br><span class="line">        cur /= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k, xroot, yroot, xl, yl, xr, yr;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; k &gt;&gt; xroot &gt;&gt; yroot &gt;&gt; xl &gt;&gt; yl &gt;&gt; xr &gt;&gt; yr;</span><br><span class="line">    k--;</span><br><span class="line">    <span class="keyword">double</span> ans = (<span class="number">2</span> * k - <span class="number">3</span> + <span class="number">3</span> * two[k]) * (xr - xl) * (yroot - yr);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Link-with-Balls"><a href="#Link-with-Balls" class="headerlink" title="Link with Balls"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7047" target="_blank" rel="noopener">Link with Balls</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给2n个盒子，其中奇数位置$pos=2x-1$​上的盒子可以拿出$kx$​个球，偶数位置$pos=2x$​上的盒子可以拿$0\sim x$个球，求要拿m个球的情况数量</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gtl1egbam0j60u40u0tcj02.jpg" alt="image-20210818164727383"></p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll fac[<span class="number">2</span> * N], rev[<span class="number">2</span> * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) (ret *= x) %= mod;</span><br><span class="line">        (x *= x) %= mod;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">2</span> * N; i++) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rev[<span class="number">0</span>] = rev[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        rev[i] = qpow(fac[i], mod - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (fac[x] * rev[x - y]) % mod * rev[y] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ((C(m + n, n) - C(m - <span class="number">1</span>, n)) % mod + mod) % mod &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Link-with-EQ"><a href="#Link-with-EQ" class="headerlink" title="Link with EQ"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7048" target="_blank" rel="noopener">Link with EQ</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>有一列长为n的椅子，第一个人随便坐那，之后的每个人都会选这样一个位置使得 他到最近的人的距离最大</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>定义$dp[len]$表示在一个长度为len的区间（这个区间最左边的左边一格坐了人，最右边的右边一个也坐了人）内选择座位的情况。</p>
<p>转移：$dp[len] = \begin{cases} 0 &amp; len\le2 \ 1+dp[\lfloor len/2 \rfloor]+dp[len-\lfloor len/2 \rfloor-1] &amp; len&gt;2 \end{cases}$</p>
<p>那么第一个人选择坐在i位置后，总人数$ans[i]=\begin{cases}2+dp[n-i-1] &amp; i\lt3 \ 3+dp[i-2]+dp[n-i-1] &amp; 3\le i\le n-2 \2+dp[i-2] &amp; i\gt n-2 \end{cases}$​</p>
<p>最终的答案就是$\sum_{i=1}^n dp[i]$，这样的复杂度是$O(n^2)$。</p>
<p>观察之后发现其实$\sum_{i=1}^n dp[i]$还能进一步化简为$\begin{cases} 2\times{3(\frac n2-2)+4+\sum_{i=1}^{n-2}dp[i]}&amp;n&amp;1=0 \ 2\times{3(\frac n2-2)+4+\sum_{i=1}^{n-2}dp[i]}+3&amp;n&amp;1=1 \end{cases} $</p>
<p>因此只要处理一下dp的前缀和即可，复杂度$O(n)$</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">3</span>; len &lt; N; len++) &#123;</span><br><span class="line">        (a[len] = <span class="number">1</span> + a[len / <span class="number">2</span>] + a[len - len / <span class="number">2</span> - <span class="number">1</span>]) %= P;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        (a[i] += a[i - <span class="number">1</span>]) %= P;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">3</span> * (n / <span class="number">2</span> - <span class="number">2</span>) + <span class="number">4</span> + a[n - <span class="number">2</span>];</span><br><span class="line">    tmp = <span class="number">2</span> * tmp;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>) tmp += <span class="number">3</span>;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; tmp * qpow(n, P - 2) % P &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Link-with-Grenade"><a href="#Link-with-Grenade" class="headerlink" title="Link with Grenade"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7049" target="_blank" rel="noopener">Link with Grenade</a></h1><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><p>一个人在空中扔炸弹，已知炸弹的初速度、爆炸时间和爆炸范围，但是不知道丢出去的角度，求这个人存活的概率</p>
<h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h3><p>（看了答案才发现，好像我想简单了，好像正确的应该是要考虑表面积什么什么的，但是我这正好瞎猫碰着死耗子算出来了）</p>
<img src="https://tva1.sinaimg.cn/large/008i3skNly1gtge8qq23qj60vt0u0q6402.jpg" alt="image-20210814162402603" style="zoom:50%;" />

<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) (ret *= x) %= P;</span><br><span class="line">        (x *= x) %= P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>) ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> g = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> t, v, r;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; t &gt;&gt; v &gt;&gt; r;</span><br><span class="line">    <span class="keyword">int</span> A = <span class="number">4</span> * g * t * t * t * v;</span><br><span class="line">    <span class="keyword">int</span> B = <span class="number">4</span> * (r * r - v * v * t * t) - g * g * t * t * t * t;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span>(B) &gt;= <span class="built_in">abs</span>(A)) <span class="built_in">cout</span> &lt;&lt; <span class="keyword">int</span>((B / <span class="built_in">abs</span>(B)) * (A / <span class="built_in">abs</span>(A)) == <span class="number">-1</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; ((A - B + P)) % P * qpow(<span class="number">2</span> * A, P - <span class="number">2</span>) % P &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Link-with-Limit"><a href="#Link-with-Limit" class="headerlink" title="Link with Limit"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7050" target="_blank" rel="noopener">Link with Limit</a></h1><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><p>很难描述，看图：<img src="https://tva1.sinaimg.cn/large/008i3skNly1gtgeb1lphqj61380d40ua02.jpg" alt="image-20210814162619046" style="zoom:33%;" /></p>
<h3 id="思路-4"><a href="#思路-4" class="headerlink" title="思路"></a>思路</h3><p>可以转化为一个图，如果这个图中有环，那么各个环上的点的平均值、链的终点应该相同（因为是取极限）</p>
<p>那么可以用DFS找到环和其平均值</p>
<p>还有其他很多种方法，比如用拓扑排序的方法做</p>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> cnt, len, col;</span><br><span class="line">&#125;;</span><br><span class="line">node vis[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y == <span class="number">0</span> ? x : gcd(y, x % y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; avg = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">bool</span> fail = <span class="number">0</span>;</span><br><span class="line">node cur;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> color)</span> </span>&#123;</span><br><span class="line">    cur.len += x;</span><br><span class="line">    cur.cnt++;</span><br><span class="line">    <span class="keyword">if</span> (vis[x].col) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[x].col == color) &#123;</span><br><span class="line">            <span class="keyword">int</span> A = cur.cnt - vis[x].cnt, B = cur.len - vis[x].len;</span><br><span class="line">            <span class="keyword">int</span> g = gcd(A, B);</span><br><span class="line">            A /= g, B /= g;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (avg.first == <span class="number">-1</span>) &#123;</span><br><span class="line">                avg = &#123;A, B&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (avg.first != A || avg.second != B) &#123;</span><br><span class="line">                fail = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    vis[x] = cur;</span><br><span class="line">    dfs(a[x], color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    </span><br><span class="line">    fail = <span class="number">0</span>;</span><br><span class="line">    avg = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) vis[i].col = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cur = &#123;<span class="number">0</span>, <span class="number">0</span>, i&#125;;</span><br><span class="line">        dfs(i, i);</span><br><span class="line">        <span class="keyword">if</span> (fail) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"NO"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"YES"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Smzzl-with-Greedy-Snake"><a href="#Smzzl-with-Greedy-Snake" class="headerlink" title="Smzzl with Greedy Snake"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7051" target="_blank" rel="noopener">Smzzl with Greedy Snake</a></h1><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><p>模拟贪吃蛇游戏</p>
<p>给你其实位置和各个食物的位置，每次吃掉一个才会出现下一个，求最短距离</p>
<h3 id="思路-5"><a href="#思路-5" class="headerlink" title="思路"></a>思路</h3><p><strong>模拟</strong></p>
<p>一个经验：以后写大模拟先想清楚，这样就能少写很多if-else 妙🐸妙🐸</p>
<h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> U cout&lt;&lt;<span class="meta-string">'u'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F cout&lt;&lt;<span class="meta-string">'f'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> C cout&lt;&lt;<span class="meta-string">'c'</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//       x  y</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; DIR[<span class="number">2</span>][<span class="number">2</span>] = &#123;&#123;&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">                          &#123;&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> go[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">0</span>,  <span class="number">1</span>&#125;,</span><br><span class="line">                &#123;<span class="number">1</span>,  <span class="number">0</span>&#125;,</span><br><span class="line">                &#123;<span class="number">0</span>,  <span class="number">-1</span>&#125;,</span><br><span class="line">                &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, d, m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; d &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> tx, ty;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; tx &gt;&gt; ty;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; cur = DIR[tx &gt; x][ty &gt; y];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> zzy = <span class="number">1</span>; zzy &gt;= <span class="number">0</span>; zzy--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (zzy == <span class="number">1</span> &amp;&amp; cur[d]) &#123;&#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cur[(d + <span class="number">1</span>) % <span class="number">4</span>]) &#123;</span><br><span class="line">                C;</span><br><span class="line">                d = (d + <span class="number">1</span>) % <span class="number">4</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur[(d + <span class="number">3</span>) % <span class="number">4</span>]) &#123;</span><br><span class="line">                U;</span><br><span class="line">                d = (d + <span class="number">3</span>) % <span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 现在方向一定是对的了</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> cnt = (tx != x) + (ty != y);</span><br><span class="line">                <span class="keyword">if</span> (cnt == zzy) <span class="keyword">break</span>;</span><br><span class="line">                x += go[d][<span class="number">0</span>], y += go[d][<span class="number">1</span>];</span><br><span class="line">                F;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Yiwen-with-Sqc"><a href="#Yiwen-with-Sqc" class="headerlink" title="Yiwen with Sqc"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7055" target="_blank" rel="noopener">Yiwen with Sqc</a></h1><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><p>给定一个字符串，对于每一个区间中的每一种字母，求其出现的数量的平方和</p>
<h3 id="思路-6"><a href="#思路-6" class="headerlink" title="思路"></a>思路</h3><p><strong>前缀和</strong></p>
<p>处理有点类似于<a href="https://acm.hdu.edu.cn/showproblem.php?pid=7020" target="_blank" rel="noopener">杭电5的Array</a>，只不过这题不用线段树/树状数组维护罢了</p>
<p>枚举26个字母，记$a_i$为该字符在原字符串中的位置，每项的长度$len_i=a_{i+1}-a_i$​。</p>
<p>枚举每一个终点i，<br>$$<br>\begin{aligned}<br>ans_k&amp;= \sum_{i=0}^{n} \sum_{j=0}^{i-1} len_i\times len_j\times(i-j)^2 \<br>   &amp;= \sum_{i=0}^{n} \sum_{j=0}^{i-1} len_i\times len_j\times(i^2-2ij+j^2) \<br>   &amp;= \sum_{i=0}^{n} \sum_{j=0}^{i-1} len_i\times[i^2(len_j)-2i(jlen_j)+(j^2len_j)] \<br>   &amp;= \sum_{i=0}^{n} len_i\times[i^2(\sum_{j=0}^{i-1}len_j)-2i(\sum_{j=0}^{i-1}jlen_j)+(\sum_{j=0}^{i-1}j^2len_j)]<br>\end{aligned}<br>$$<br>因此我们只要维护三个标记$\begin{cases}l_1=\sum len_j \ l_2=\sum j\times len_j \ l_3=\sum j^2\times len_j \end{cases}$​</p>
<p>最终的答案就是$ans=\sum i^2l_1-2il_2+l_3$​</p>
<p>5555555比赛的时候写出来了，肋木了</p>
<h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">26</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> P = <span class="number">998244353</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> s;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">    <span class="keyword">int</span> len = s.length();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        a[i].clear();</span><br><span class="line">        a[i].push_back(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123; </span><br><span class="line">        a[s[i] - <span class="string">'a'</span>].push_back(i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;cur: a) &#123;</span><br><span class="line">        <span class="keyword">int</span> sz = cur.size();</span><br><span class="line">        cur.push_back(len + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz; j++) &#123;</span><br><span class="line">            cur[j] = cur[j + <span class="number">1</span>] - cur[j];</span><br><span class="line">        &#125;</span><br><span class="line">        cur.pop_back();</span><br><span class="line">        ll l1 = <span class="number">0</span>, l2 = <span class="number">0</span>, l3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; sz; i++) &#123;</span><br><span class="line">            (ans += (((((l1 * i) % P * i) % P - (<span class="number">2</span> * i * l2) % P) % P + l3) % P) * cur[i] % P) %= P;</span><br><span class="line">            (l1 += cur[i]) %= P;</span><br><span class="line">            (l2 += (i * cur[i]) % P) %= P;</span><br><span class="line">            (l3 += (i * i) % P * cur[i] % P) %= P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (ans + P) % P &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A18/" class="post-title-link" itemprop="url">2021牛客多校8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-10 19:02:30" itemprop="dateCreated datePublished" datetime="2021-08-10T19:02:30+08:00">2021-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 16:05:28" itemprop="dateModified" datetime="2021-08-13T16:05:28+08:00">2021-08-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="OR"><a href="#OR" class="headerlink" title="OR"></a><a href="https://ac.nowcoder.com/acm/contest/11259/D" target="_blank" rel="noopener">OR</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给出两个数组b、c，求有多少个a数组使得：$b[i] = a[i-1]\ or\ a[i]$​、$c[i]=a[i-1]+a[i]$​​。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>关键一步：$d[i] = c[i]-b[i]=a[i-1]\ and\ a[i]$</p>
<p>所以这题实际上是给出了a数组中相邻两个数的按位与和按位或的情况。</p>
<p>对每一位考虑，只要知道了a[1]在这位的取值，后面的值就也知道了。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, b[N], c[N], d[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; b[i]; <span class="comment">//or</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; c[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) d[i] = c[i] - b[i]; <span class="comment">//and</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">30</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> ok = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> zzy = <span class="number">0</span>; zzy &lt; <span class="number">2</span>; zzy++) &#123;</span><br><span class="line">            <span class="comment">// 第一位填什么</span></span><br><span class="line">            <span class="keyword">bool</span> pre = zzy;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> OR = (b[j] &gt;&gt; i) &amp; <span class="number">1</span>, AND = (d[j] &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (OR == <span class="number">0</span> &amp;&amp; AND == <span class="number">0</span> &amp;&amp; pre == <span class="number">0</span> || OR == <span class="number">1</span> &amp;&amp; AND == <span class="number">1</span> &amp;&amp; pre == <span class="number">1</span>) &#123;&#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (OR == <span class="number">1</span> &amp;&amp; AND == <span class="number">0</span>) &#123;</span><br><span class="line">                    pre ^= <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (j == n) ok++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ok) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans *= ok;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Robots"><a href="#Robots" class="headerlink" title="Robots"></a><a href="https://ac.nowcoder.com/acm/contest/11259/F" target="_blank" rel="noopener">Robots</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>有一个n*m的矩形，每个格子有0/1两种状态，0代表路，1代表障碍物，有三种机器人：一种只能向右，一种只能向下，一种又能向右又能向下。对于每次询问，给出起点、终点和机器人的种类，求该机器人能不能从起点走到终点</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><h4 id="做法1-动态规划-dp-离线"><a href="#做法1-动态规划-dp-离线" class="headerlink" title="做法1:动态规划 dp 离线"></a>做法1:<strong>动态规划 dp 离线</strong></h4><p>状态定义：$dp[i][j][k][l]$​​代表$(k, l)$​能不能走到$(i, j)$</p>
<p>状态转移：$dp[i][j][k][l] = \begin{cases} dp[i-1][j][k][l]\ or \ dp[i][j-1][k][l] &amp; a[i][j]=1 \ 0 &amp; a[i][j]=0 \end{cases} $​​ 并且$a[i][j]=1$时，$dp[i][j][i][j]=1$</p>
<p>乍一看：时间和空间复杂度都是$O(n^4)$​，但是！</p>
<ul>
<li>看第3、4维：这里的$k、l$如果用bitset表示的话，那么 $dp[i][j]=dp[i-1][j]\ or \ dp[i][j-1]$​</li>
<li>看第1维：这里的$i$​​只能由$i-1$​或$i$​​转移而来，因此可以用滚动数组优化</li>
</ul>
<p>将查询离线下来就行</p>
<p>如果用bitset，复杂度相当于是$O(\frac{1}{64}n^4)$。用bitset我测要1000ms，用bool数组的话会T，下面的分治法只要250ms，但是这题时间给了5000ms，应该是数据不够强吧。。</p>
<h4 id="做法2-分治法"><a href="#做法2-分治法" class="headerlink" title="做法2:分治法"></a>做法2:<strong>分治法</strong></h4><p>其实是在做法1的基础上优化的，同样需要将每次查询离线。</p>
<p>定义一个函数$f(l, r)$，如果起点和终点满足$x\in[l, r]$，就会返回能否到达，其解决的方法为：</p>
<ol>
<li>每次将当前的区间分成上下两半$(l, mid)、(mid+1, r)$</li>
<li>如果起点终点的x坐标都在上半区间或者都在下半区间，那么就调用$f(l, mid)$或者$f(mid+1, r)$​</li>
<li>否则用dp处理上半部分到mid和mid到下半部分的情况($dp[i][j][k]$​​​表示(i, j)能不能到$(mid, k)$​，具体转移过程可以看法1)</li>
<li>如果存在k使得$dp[x_{start}][y_{start}][k]\ &amp;\  dp[x_{end}][y_{end}][k]=1$​，则可达。</li>
</ol>
<p>其复杂度为$O(q\log n+n^3\log\frac n{32})$​​​，但是可能常数很大吧。代码略</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">550</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, idx;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="built_in">string</span> a[N];</span><br><span class="line"><span class="comment">//bool dp[N][N][N];</span></span><br><span class="line"><span class="built_in">bitset</span>&lt;N * N&gt; dp[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; q[N][N];</span><br><span class="line"><span class="keyword">bool</span> ans[<span class="number">500010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        a[i] = <span class="string">'0'</span> + a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> qn;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; qn;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; qn; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> t, sx, sy, tx, ty;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; t &gt;&gt; sx &gt;&gt; sy &gt;&gt; tx &gt;&gt; ty;</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sy != ty || sx &gt; tx) ans[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ans[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = sx; j &lt;= tx; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a[j][ty] == <span class="string">'1'</span>) &#123;</span><br><span class="line">                        ans[i] = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sx != tx || sy &gt; ty) ans[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ans[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = sy; j &lt;= ty; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a[tx][j] == <span class="string">'1'</span>) &#123;</span><br><span class="line">                        ans[i] = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q[tx][ty].push_back(&#123;sx, sy, i&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i][j] == <span class="string">'1'</span>) &#123;</span><br><span class="line">                dp[j].reset();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[j][i * N + j] = <span class="number">1</span>;</span><br><span class="line">                dp[j] |= dp[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> x: q[i][j]) &#123;</span><br><span class="line">                ans[x.idx] = dp[j][x.x * N + x.y];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; qn; i++) <span class="built_in">cout</span> &lt;&lt; (ans[i] ? <span class="string">"yes"</span> : <span class="string">"no"</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A17/" class="post-title-link" itemprop="url">2021牛客多校7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-10 19:02:10" itemprop="dateCreated datePublished" datetime="2021-08-10T19:02:10+08:00">2021-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 22:54:49" itemprop="dateModified" datetime="2021-08-13T22:54:49+08:00">2021-08-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="xay-loves-trees"><a href="#xay-loves-trees" class="headerlink" title="xay loves trees"></a><a href="https://ac.nowcoder.com/acm/contest/11258/F" target="_blank" rel="noopener">xay loves trees</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给两棵都以1为根结点、长度相同的树，求一个序列使得：这个序列的所有值在树1中两两为祖先儿子关系，在树2中两两不是祖先儿子关系。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p><strong>DFS序 树状数组/线段树</strong></p>
<p>DFS序：每个节点在dfs深度优先遍历中的进出栈的时间序列。</p>
<p>其伪代码为：</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">time = <span class="number">0</span>;</span><br><span class="line">dfs(int <span class="symbol">x</span>) &#123;</span><br><span class="line">    in[<span class="symbol">x</span>] = ++time;</span><br><span class="line">    <span class="keyword">for</span> (<span class="symbol">x</span>结点的每个孩子结点<span class="symbol">y</span>) &#123;</span><br><span class="line">        dfs(<span class="symbol">y</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    out[<span class="symbol">x</span>] = ++time;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以从中得到一个很重要的性质：每个节点x的孩子结点的进出时间都一定在$[in[x], out[x]]$​，并且每个节点的进出时间都不相交。</p>
<p>回到这道题，首先处理树1，我们可以遍历每一个节点，找到这个节点的最长链，如果当前这个最长链不满足树2的限制，就不断地最高的节点踢掉，直到满足。</p>
<p>而对于树2的check，我们可以用一个线段树/树状数组来维护，每加入一个节点，我们就对$[in[x], out[x]]$​区间加1，这样如果出现了某个区间的值大于1，则说明当前选择的序列中存在祖先关系，则不满足条件。</p>
<p>关键代码其实就是dfs函数。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> left, right;</span><br><span class="line">    ll data, lazy = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">node tree[<span class="number">4</span> * maxn];</span><br><span class="line"></span><br><span class="line"><span class="comment">// tree[0] -&gt; pos = 1, l = 1, r = n;</span></span><br><span class="line"><span class="comment">// 建线段树</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    tree[pos].data = tree[pos].lazy = <span class="number">0</span>;</span><br><span class="line">    tree[pos].left = l;</span><br><span class="line">    tree[pos].right = r;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">    build(<span class="number">2</span> * pos, l, mid);</span><br><span class="line">    build(<span class="number">2</span> * pos + <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将lazy向下传</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spear</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    tree[<span class="number">2</span> * i].lazy += tree[i].lazy;</span><br><span class="line">    tree[<span class="number">2</span> * i].data += tree[i].lazy * (tree[<span class="number">2</span> * i].right - tree[<span class="number">2</span> * i].left + <span class="number">1</span>);</span><br><span class="line">    tree[<span class="number">2</span> * i + <span class="number">1</span>].lazy += tree[i].lazy;</span><br><span class="line">    tree[<span class="number">2</span> * i + <span class="number">1</span>].data += tree[i].lazy * (tree[<span class="number">2</span> * i + <span class="number">1</span>].right - tree[<span class="number">2</span> * i + <span class="number">1</span>].left + <span class="number">1</span>);</span><br><span class="line">    tree[i].lazy = <span class="number">0</span>;</span><br><span class="line">    tree[i].data = tree[<span class="number">2</span> * i].data + tree[<span class="number">2</span> * i + <span class="number">1</span>].data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给区间[l, r]加上x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt; r || tree[i].right &lt; l) &#123; <span class="comment">// 在所查询区间外</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt;= l &amp;&amp; tree[i].right &lt;= r) &#123; <span class="comment">// 包括在所查询区间内</span></span><br><span class="line">        tree[i].lazy += x;</span><br><span class="line">        tree[i].data += x * (tree[i].right - tree[i].left + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    spear(i);</span><br><span class="line">    update(<span class="number">2</span> * i, l, r, x);</span><br><span class="line">    update(<span class="number">2</span> * i + <span class="number">1</span>, l, r, x);</span><br><span class="line">    tree[i].data = tree[<span class="number">2</span> * i].data + tree[<span class="number">2</span> * i + <span class="number">1</span>].data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 求区间[l, r]的和</span></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt; r || tree[i].right &lt; l) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt;= l &amp;&amp; tree[i].right &lt;= r) &#123; <span class="comment">// 包括在所查询区间内</span></span><br><span class="line">        <span class="keyword">return</span> tree[i].data;</span><br><span class="line">    &#125;</span><br><span class="line">    spear(i);</span><br><span class="line">    <span class="keyword">return</span> query(<span class="number">2</span> * i, l, r) + query(<span class="number">2</span> * i + <span class="number">1</span>, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a[maxn], b[maxn];</span><br><span class="line"><span class="keyword">int</span> in[maxn], out[maxn];</span><br><span class="line"><span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfn</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123; <span class="comment">// dfs-&gt;2</span></span><br><span class="line">    in[x] = ++t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y: b[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfn(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    out[x] = ++t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; dq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123; <span class="comment">// dfs -&gt; 1</span></span><br><span class="line">    <span class="comment">// 枚举这个点能往上走多远</span></span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; sta;</span><br><span class="line">    <span class="keyword">while</span> (query(<span class="number">1</span>, in[x], out[x])) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = dq.front();</span><br><span class="line">        update(<span class="number">1</span>, in[tmp], out[tmp], <span class="number">-1</span>);</span><br><span class="line">        sta.push(tmp), dq.pop_front();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dq.push_back(x);</span><br><span class="line">    update(<span class="number">1</span>, in[x], out[x], <span class="number">1</span>);</span><br><span class="line">    ans = max(ans, (<span class="keyword">int</span>) dq.size());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y: a[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 还原</span></span><br><span class="line">    <span class="keyword">while</span> (!sta.empty()) &#123;</span><br><span class="line">        update(<span class="number">1</span>, in[sta.top()], out[sta.top()], <span class="number">1</span>);</span><br><span class="line">        dq.push_front(sta.top()), sta.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    dq.pop_back();</span><br><span class="line">    update(<span class="number">1</span>, in[x], out[x], <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    build(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span> * n + <span class="number">10</span>);</span><br><span class="line">    ans = t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i].clear(), b[i].clear();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        a[x].push_back(y);</span><br><span class="line">        a[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        b[x].push_back(y);</span><br><span class="line">        b[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dfn(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="xay-loves-count"><a href="#xay-loves-count" class="headerlink" title="xay loves count"></a><a href="https://ac.nowcoder.com/acm/contest/11258/H" target="_blank" rel="noopener">xay loves count</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给定一个数组($0&lt;a_i&lt;10^6$)，求有多少对$a_i \times a_j=a_k$</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>观察到$a_i$很小，保存每个数字出现的次数，用类似筛质数的方法就可以处理出所有的答案了。</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 压行压的玩的</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ll n, cnt[N], ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; i++) <span class="built_in">cin</span> &gt;&gt; x, cnt[x]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * i &lt; N; j++) ans += cnt[j] * cnt[i] * cnt[i * j];</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="xay-loves-Floyd"><a href="#xay-loves-Floyd" class="headerlink" title="xay loves Floyd"></a><a href="https://ac.nowcoder.com/acm/contest/11258/J" target="_blank" rel="noopener">xay loves Floyd</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>众所周知，Floyd的正确顺序是k-i-j，但是如果写成i-j-k，会有多少个最短距离是正确的呢？</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>先对每一个点跑一遍dij，算出最短距离的正确答案，然后遍历每一条边$(u, v)$，如果这条边的距离等于$dis[u][v]$，那么就说明这条边一定可以，我们用$ok[i][j]$代表$dis[i][j]$会是正确的。那么我们可以模拟i-j-k的运算，如果有<code>ok[i][k] &amp;&amp; ok[k][j] &amp;&amp; dis[i][j] == dis[i][k] + dis[k][j]</code>(意思是：(i, k)和(k, j)是正确的，并且k点可以作为i、j的中转点)那么我们就可以$ok[i][j]$赋为1了。</p>
<p>但是这样的复杂度是$O(nm\log n + n^3)$会T，需要稍作优化。</p>
<p>我们可以每次处理到$ok[i][k]$为1时，我们可以额外用一个vector储存k值，这样我们就可以不用遍历所有的k了。</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> INF = <span class="number">5e8</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> w first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> t second</span></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; node;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;node&gt; e[N];</span><br><span class="line"><span class="keyword">int</span> min_e[N][N];</span><br><span class="line"><span class="keyword">bool</span> ok[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            min_e[i][j] = INF;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">bitset</span>&lt;N&gt; vis;</span><br><span class="line">        priority_queue&lt;node, <span class="built_in">vector</span>&lt;node&gt;, greater&lt;&gt; &gt; pq;</span><br><span class="line">        pq.push(&#123;<span class="number">0</span>, i&#125;);</span><br><span class="line">        <span class="keyword">while</span> (!pq.empty()) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = pq.top().t, w = pq.top().w;</span><br><span class="line">            pq.pop();</span><br><span class="line">            <span class="keyword">if</span> (vis[j]) <span class="keyword">continue</span>;</span><br><span class="line">            vis[j] = <span class="number">1</span>;</span><br><span class="line">            min_e[i][j] = w;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> k: e[j]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (vis[k.t]) <span class="keyword">continue</span>;</span><br><span class="line">                pq.push(&#123;k.w + min_e[i][j], k.t&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        in(x, y, z);</span><br><span class="line">        e[x].push_back(&#123;z, y&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dij();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// 关键代码 50-76</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j: e[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (min_e[i][j.t] == j.w) &#123;</span><br><span class="line">                ok[i][j.t] = <span class="number">1</span>;</span><br><span class="line">                g[i].push_back(j.t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (min_e[i][j] == INF || ok[i][j] || i == j) &#123;</span><br><span class="line">                ans++;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k : g[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ok[k][j] &amp;&amp; min_e[i][j] == min_e[i][k] + min_e[k][j]) &#123;</span><br><span class="line">                    ok[i][j] = <span class="number">1</span>;</span><br><span class="line">                    g[i].push_back(j);</span><br><span class="line">                    ans++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A16/" class="post-title-link" itemprop="url">2021杭电多校6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-08 18:37:50" itemprop="dateCreated datePublished" datetime="2021-08-08T18:37:50+08:00">2021-08-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-10 01:15:19" itemprop="dateModified" datetime="2021-08-10T01:15:19+08:00">2021-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Yes-Prime-Minister"><a href="#Yes-Prime-Minister" class="headerlink" title="Yes, Prime Minister"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7025" target="_blank" rel="noopener">Yes, Prime Minister</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给定一个数$x$，求一个长度最小的区间使得$x \in [l, r]$​，输出这个长度</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>对于$l&gt;0$而言，如果$sum{l, r}$为质数，那么一定有$r-l&lt;=1$。（因为$sum{l, r}=\frac{(l+r)(r-l+1)}2$）</p>
<p>而对于负数x而言，我们一定可以找到一个负数l和正数r使得$sum{l, r}$为质数</p>
<p>对于正数而言，如果$sum{x-1, x}、sum{x, x+1}、x$​都不是质数，同样可以找到一个负数l和正数r使得$sum{l, r}$​为质数</p>
<p>我们可以暴力的寻找这个r</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">3e7</span>;</span><br><span class="line"><span class="keyword">bool</span> isPrime[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(isPrime, <span class="number">1</span>, <span class="keyword">sizeof</span>(isPrime));</span><br><span class="line">    isPrime[<span class="number">0</span>] = isPrime[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isPrime[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; i * j &lt; N; j++) &#123;</span><br><span class="line">            isPrime[i * j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">0</span> &amp;&amp; isPrime[x]) ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &gt; <span class="number">0</span> &amp;&amp; (isPrime[<span class="number">2</span> * x - <span class="number">1</span>] || isPrime[<span class="number">2</span> * x + <span class="number">1</span>])) ans = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="built_in">abs</span>(x);</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            x++;</span><br><span class="line">            <span class="keyword">if</span> (isPrime[x]) &#123;</span><br><span class="line">                ans = <span class="number">2</span> * x;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (isPrime[<span class="number">2</span> * x + <span class="number">1</span>]) &#123;</span><br><span class="line">                ans = <span class="number">2</span> * x + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Median"><a href="#Median" class="headerlink" title="Median"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7029" target="_blank" rel="noopener">Median</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给定n和b数组，求如何划分[1, n]中的n个数到m个集合中，使得每个集合中的中位数都属于b数组。</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><strong>构造 贪心?</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gt9pd4ljm5j31es0k0agb.jpg" alt="image-20210808212957112"></p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    sort(a, a + m);</span><br><span class="line">    a[m] = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxIdx = <span class="number">0</span>, imax = a[<span class="number">0</span>] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] - a[i - <span class="number">1</span>] - <span class="number">1</span> &gt;= imax) &#123;</span><br><span class="line">            imax = a[i] - a[i - <span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">            maxIdx = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    imax -= (n - m - imax);</span><br><span class="line">    <span class="keyword">if</span> (maxIdx &gt;= imax) <span class="built_in">cout</span> &lt;&lt; <span class="string">"YES"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"NO"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A15/" class="post-title-link" itemprop="url">2021杭电多校5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-08 18:37:38" itemprop="dateCreated datePublished" datetime="2021-08-08T18:37:38+08:00">2021-08-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-29 21:46:01" itemprop="dateModified" datetime="2021-09-29T21:46:01+08:00">2021-09-29</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Another-String"><a href="#Another-String" class="headerlink" title="Another String"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7015" target="_blank" rel="noopener">Another String</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给一个长为n的字符串s和整数k，对于每一个$i \in [1, n-1]$，求$S[1, i]$ 和 $S[i+1, n]$有多少个长度相等的子串满足不同的字符的数量小于k</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>分两步进行：</p>
<ol>
<li><p>处理$G[i][j]$</p>
<p>定义：$G[i][j]$为以i、j开始的字符串满足条件的最大长度</p>
<p>定义d为j-i，对于每一个d，由于$G[i][j]$可以由$G[i][j-]$得到，所以我们可以在$O(n)$的时间用双指针求出$G[i][j]$的值</p>
</li>
<li><p>计算答案</p>
<p>答案的原始公式为$ans[t]=\sum_{i=1}^{t-1}\sum_{j=t}^n\min(G[i][j], t-i)$​暴力计算的话为$O(n^3)$，显然需要优化</p>
<p>我们遍历每一个i，从大到小计算ans[t]，在计算ans[t]的时候可以基于ans[t+1]的情况来修改，</p>
<p>我们可以维护一个cnt数组，$cnt[x]$​代表$G[i][j]=x$​的次数，每次t变化的时候，t-i就会减少1，那么我们就可以将cnt[大于t-i]的数减少为cnt[t-i]，代表这些数都只能取到t-i了。</p>
<p>（真的很绕… 我再把官方题解贴上来）</p>
</li>
</ol>
<img src="https://tva1.sinaimg.cn/large/008i3skNly1gt9owb4cp8j31fn0u0n3s.jpg" alt="image-20210808211347248" style="zoom:25%;" />

<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">3000</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> dp[N][N], ans[N];</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; s;</span><br><span class="line">    s = <span class="string">'0'</span> + s;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 第一步 双指针处理dp数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt; n; d++) &#123; <span class="comment">// l 和 r 的差</span></span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">1</span>, cur = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = l;; r++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (r + d &gt; n) &#123;</span><br><span class="line">                <span class="keyword">for</span> (; l + d &lt;= n; l++) dp[l][l + d] = r - l ;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (s[r] != s[r + d]) cur++;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (cur &gt; k) &#123;</span><br><span class="line">                dp[l][l + d] = r - l;</span><br><span class="line">                <span class="keyword">if</span> (s[l] != s[l + d]) cur--;</span><br><span class="line">                l++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123; <span class="comment">// 枚举左区间的左端点</span></span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">cnt</span><span class="params">(n + <span class="number">10</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = n; t &gt; i; t--) &#123; <span class="comment">// 枚举分界线</span></span><br><span class="line">            <span class="keyword">int</span> imax = t - i;</span><br><span class="line">            <span class="keyword">if</span> (imax &gt; dp[i][t]) &#123;</span><br><span class="line">                cnt[dp[i][t]]++;</span><br><span class="line">                sum += dp[i][t];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cnt[imax]++;</span><br><span class="line">                sum += imax;</span><br><span class="line">            &#125;</span><br><span class="line">            cnt[imax] += cnt[imax + <span class="number">1</span>];</span><br><span class="line">            sum -= cnt[imax + <span class="number">1</span>];</span><br><span class="line">            ans[t] += sum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Array"><a href="#Array" class="headerlink" title="Array"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=7020" target="_blank" rel="noopener">Array</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给一个数组，求有多少个区间具有绝对众数</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gtb0lmklabj31ak0u045k.jpg" alt="IMG_0728"></p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">// xu! zhe duan dai ma hui T!</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> left, right;</span><br><span class="line">    ll data;</span><br><span class="line">    ll ldata = <span class="number">0</span>, lcnt = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">node tree[<span class="number">8</span> * maxn];</span><br><span class="line"></span><br><span class="line"><span class="comment">// tree[0] -&gt; pos = 1, l = 1, r = n;</span></span><br><span class="line"><span class="comment">// 建线段树</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    tree[pos].left = l;</span><br><span class="line">    tree[pos].right = r;</span><br><span class="line">    tree[pos].data = tree[pos].ldata = tree[pos].lcnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(<span class="number">2</span> * pos, l, mid);</span><br><span class="line">    build(<span class="number">2</span> * pos + <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将lazy向下传</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spear</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">2</span> * i; u &lt;= <span class="number">2</span> * i + <span class="number">1</span>; u++) &#123;</span><br><span class="line">        <span class="keyword">int</span> L = tree[u].left, R = tree[u].right;</span><br><span class="line">        tree[u].ldata += tree[i].ldata;</span><br><span class="line">        tree[u].lcnt += tree[i].lcnt;</span><br><span class="line">        tree[u].data += (L + R) * (R - L + <span class="number">1</span>) / <span class="number">2</span> * tree[i].lcnt - tree[i].ldata * (R - L + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    tree[i].ldata = tree[i].lcnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给区间[l, r]加上x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addInterval</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll x, <span class="keyword">int</span> dcnt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt; r || tree[i].right &lt; l) &#123; <span class="comment">// 在所查询区间外</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt;= l &amp;&amp; tree[i].right &lt;= r) &#123; <span class="comment">// 包括在所查询区间内</span></span><br><span class="line">        tree[i].ldata += x;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> L = tree[i].left, R = tree[i].right;</span><br><span class="line"></span><br><span class="line">        tree[i].lcnt += dcnt;</span><br><span class="line">        tree[i].data += (L + R) * (R - L + <span class="number">1</span>) * dcnt / <span class="number">2</span> - x * (R - L + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    spear(i);</span><br><span class="line">    addInterval(<span class="number">2</span> * i, l, r, x, dcnt);</span><br><span class="line">    addInterval(<span class="number">2</span> * i + <span class="number">1</span>, l, r, x, dcnt);</span><br><span class="line">    tree[i].data = tree[<span class="number">2</span> * i].data + tree[<span class="number">2</span> * i + <span class="number">1</span>].data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 求区间[l, r]的和</span></span><br><span class="line"><span class="function">ll <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt; r || tree[i].right &lt; l) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt;= l &amp;&amp; tree[i].right &lt;= r) &#123; <span class="comment">// 包括在所查询区间内</span></span><br><span class="line">        <span class="keyword">return</span> tree[i].data;</span><br><span class="line">    &#125;</span><br><span class="line">    spear(i);</span><br><span class="line">    <span class="keyword">return</span> sum(<span class="number">2</span> * i, l, r) + sum(<span class="number">2</span> * i + <span class="number">1</span>, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a[maxn];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">        a[x].push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i].size() == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> pre = <span class="number">0</span>;</span><br><span class="line">        a[i].push_back(n + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> sz = a[i].size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> len = a[i][j + <span class="number">1</span>] - a[i][j]; <span class="comment">// 将一个1和他后面的连续-1一起处理了</span></span><br><span class="line">            ans += sum(<span class="number">1</span>, pre + <span class="number">1</span> - len, pre);</span><br><span class="line">            addInterval(<span class="number">1</span>, pre + <span class="number">2</span> - len, pre + <span class="number">1</span>, pre + <span class="number">1</span> - len, <span class="number">1</span>);</span><br><span class="line">            addInterval(<span class="number">1</span>, pre + <span class="number">1</span> + <span class="number">1</span>, n, -len, <span class="number">0</span>);</span><br><span class="line">            pre = pre + <span class="number">2</span> - len;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 将修改还原 避免每次都要重新覆盖数组</span></span><br><span class="line">        pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> len = a[i][j + <span class="number">1</span>] - a[i][j];</span><br><span class="line">            addInterval(<span class="number">1</span>, pre + <span class="number">2</span> - len, pre + <span class="number">1</span>, -(pre + <span class="number">1</span> - len), <span class="number">-1</span>);</span><br><span class="line">            addInterval(<span class="number">1</span>, pre + <span class="number">1</span> + <span class="number">1</span>, n, len, <span class="number">0</span>);</span><br><span class="line">            pre = pre + <span class="number">2</span> - len;</span><br><span class="line">        &#125;</span><br><span class="line">        a[i].clear();</span><br><span class="line">        a[i].push_back(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++) a[i].push_back(<span class="number">0</span>);</span><br><span class="line">    build(<span class="number">1</span>, -maxn, maxn);</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A16/" class="post-title-link" itemprop="url">2021牛客多校6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-31 18:04:13" itemprop="dateCreated datePublished" datetime="2021-07-31T18:04:13+08:00">2021-07-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-26 15:56:04" itemprop="dateModified" datetime="2021-09-26T15:56:04+08:00">2021-09-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Hamburger-Steak"><a href="#Hamburger-Steak" class="headerlink" title="Hamburger Steak"></a><a href="https://ac.nowcoder.com/acm/contest/11257/F" target="_blank" rel="noopener">Hamburger Steak</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>有 n 个汉堡排和 m 个锅，给出每个汉堡排需要煎的时间 $t_i$。一个汉堡排可以在一口锅中煎好，也可以分成两次在两个锅中煎好。一个锅同时只能煎一个汉堡排，一个汉堡排同时只能放到一个锅中。求一个方案使煎好所有的汉堡排所需要的时间最少（尽早煎完）。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p><strong>贪心</strong>，太妙了..</p>
<p>假设我们知道了最小耗时 T，就可以贪心地将每个锅的时间 T 依次分配给每个汉堡排，当前这个锅没煎完的部分再由下个锅煎即可。为了满足题目要求，我们需要保证所有锅的时间和大于等于所有汉堡排的时间和，以及耗时最长的汉堡排不会在同一时刻分到两个锅中（耗时小于它的自然也就满足条件），于是最小耗时为 $T=\max⁡ { t_i,⌈\frac {\sum t_i}m⌉}$<font style="opacity: 0">==todo==</font></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        t = max(t, a[i]);</span><br><span class="line">        sum += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    t = max(t, (sum + m - <span class="number">1</span>) / m);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> idx = <span class="number">0</span>; idx &lt; n; idx++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur + a[idx] &lt;= t) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; i &lt;&lt; <span class="string">' '</span> &lt;&lt; cur &lt;&lt; <span class="string">' '</span> &lt;&lt; cur + a[idx] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">' '</span> &lt;&lt;</span><br><span class="line">                 i + <span class="number">1</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; a[idx] + cur - t &lt;&lt; <span class="string">' '</span></span><br><span class="line">                 &lt;&lt; i &lt;&lt; <span class="string">' '</span> &lt;&lt; cur &lt;&lt; <span class="string">' '</span> &lt;&lt; t  &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur += a[idx];</span><br><span class="line">        <span class="keyword">if</span> (cur &gt;= t) &#123;</span><br><span class="line">            cur -= t;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Hopping-Rabbit"><a href="#Hopping-Rabbit" class="headerlink" title="Hopping Rabbit"></a><a href="https://ac.nowcoder.com/acm/contest/11257/H" target="_blank" rel="noopener">Hopping Rabbit</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>平面上有 n 个矩形陷阱，给定d，需要找到一个位置 (x,y)，使得所有 (x+kd,y+kd) 均不落在矩形中。</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><strong>扫描线</strong></p>
<p>首先将本题抽象一下，可以将这n个矩形都先投影到d*d大小的矩形中，如果这个矩形中有一个点没有被陷阱标记，则该点满足要求。</p>
<p>抽象之后其实就是要找多个矩形的面积之和了，之后的内容其实就相当于是一个扫描线的板子了。</p>
<p>要输出方案，我们可以遍历每一个y，如果这个y对应的区间长度小于d，就说明有的点没有被覆盖，我们可以通过不断查找其左右子节点找到。</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> left, right;</span><br><span class="line">    ll sum; <span class="comment">//区间被标记过几次</span></span><br><span class="line">    ll len; <span class="comment">//区间对应的正式的长度</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ？？？？为什么一定要开6倍的maxn？？？</span></span><br><span class="line">node tree[<span class="number">6</span> * maxn];</span><br><span class="line"></span><br><span class="line"><span class="comment">// tree[0] -&gt; pos = 1, l = 1, r = n;</span></span><br><span class="line"><span class="comment">// 建线段树</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    tree[pos].left = l;</span><br><span class="line">    tree[pos].right = r;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">    build(<span class="number">2</span> * pos, l, mid);</span><br><span class="line">    build(<span class="number">2</span> * pos + <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = x * <span class="number">2</span>, r = x * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (tree[x].sum) tree[x].len = tree[x].right - tree[x].left + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> tree[x].len = tree[l].len + tree[r].len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给区间[l, r]加上x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addInterval</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt;= l &amp;&amp; tree[i].right &lt;= r) &#123; <span class="comment">// 包括在所查询区间内</span></span><br><span class="line">        tree[i].sum += x;</span><br><span class="line">        pushup(i);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tree[i].left &gt; r || tree[i].right &lt; l) &#123; <span class="comment">// 在所查询区间外</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    addInterval(<span class="number">2</span> * i, l, r, x);</span><br><span class="line">    addInterval(<span class="number">2</span> * i + <span class="number">1</span>, l, r, x);</span><br><span class="line">    pushup(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ------</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sl</span> &#123;</span> <span class="comment">//scannerLine</span></span><br><span class="line">    <span class="keyword">int</span> xl, xr, flag;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getX</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tree[cur].left == tree[cur].right) <span class="keyword">return</span> tree[cur].left;</span><br><span class="line">        <span class="keyword">int</span> l = cur * <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (tree[l].len != tree[l].right + <span class="number">1</span> - tree[l].left) cur = l;</span><br><span class="line">        <span class="keyword">else</span> cur = l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m, d;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m &gt;&gt; d;</span><br><span class="line">    <span class="built_in">vector</span>&lt;sl&gt; v[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> xl, yl, xr, yr;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; xl &gt;&gt; yl &gt;&gt; xr &gt;&gt; yr;</span><br><span class="line">        xl += <span class="number">1e9</span>, yl += <span class="number">1e9</span>, xr += <span class="number">1e9</span>, yr += <span class="number">1e9</span>;</span><br><span class="line">        <span class="comment">// 将矩形投影</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; x, y;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (xl / d == xr / d) &#123;</span><br><span class="line">            xl %= d, xr %= d;</span><br><span class="line">            x.push_back(&#123;xl, xr&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (xr - xl &gt;= d) &#123;</span><br><span class="line">            x.push_back(&#123;<span class="number">0</span>, d&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            xl %= d, xr %= d;</span><br><span class="line">            x.push_back(&#123;xl, d&#125;);</span><br><span class="line">            x.push_back(&#123;<span class="number">0</span>, xr&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (yl / d == yr / d) &#123;</span><br><span class="line">            yl %= d, yr %= d;</span><br><span class="line">            y.push_back(&#123;yl, yr&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (yr - yl &gt;= d) &#123;</span><br><span class="line">            y.push_back(&#123;<span class="number">0</span>, d&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            yl %= d, yr %= d;</span><br><span class="line">            y.push_back(&#123;yl, d&#125;);</span><br><span class="line">            y.push_back(&#123;<span class="number">0</span>, yr&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> xx : x) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> yy: y) &#123;</span><br><span class="line">                v[yy.first].push_back(&#123;xx.first, xx.second, <span class="number">1</span>&#125;);</span><br><span class="line">                v[yy.second].push_back(&#123;xx.first, xx.second, <span class="number">-1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    build(<span class="number">1</span>, <span class="number">0</span>, d - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; d; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> vv: v[y]) &#123;</span><br><span class="line">            addInterval(<span class="number">1</span>, vv.xl, vv.xr - <span class="number">1</span>, vv.flag);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tree[<span class="number">1</span>].len != d) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"YES"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; getX() - <span class="keyword">int</span>(<span class="number">1e9</span>) &lt;&lt; <span class="string">' '</span> &lt;&lt; y - <span class="keyword">int</span>(<span class="number">1e9</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"NO"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Intervals-on-the-Ring"><a href="#Intervals-on-the-Ring" class="headerlink" title="Intervals on the Ring"></a><a href="https://ac.nowcoder.com/acm/contest/11257/I" target="_blank" rel="noopener">Intervals on the Ring</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>给一个环和该环上的数个区间X，求一个区间集合Y，使得Y的交集等于X的并集</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p><strong>模拟</strong></p>
<p>先排序，然后输出第i个区间的开头和第i-1个区间的结尾即可。比赛的时候脑子糊了🥲</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">vector</span>&lt;pp&gt; v;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        pp p;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; p.first &gt;&gt; p.second;</span><br><span class="line">        v.push_back(p);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sort(v.begin(), v.end());</span><br><span class="line">    v.push_back(v.front());</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; m &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">cout</span> &lt;&lt; v[i].first &lt;&lt; <span class="string">' '</span> &lt;&lt; v[i - <span class="number">1</span>].second &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A15/" class="post-title-link" itemprop="url">2021牛客多校5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-31 18:04:13" itemprop="dateCreated datePublished" datetime="2021-07-31T18:04:13+08:00">2021-07-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-06 00:17:42" itemprop="dateModified" datetime="2021-08-06T00:17:42+08:00">2021-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Boxes"><a href="#Boxes" class="headerlink" title="Boxes"></a><a href="https://ac.nowcoder.com/acm/contest/11256/B" target="_blank" rel="noopener">Boxes</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>有n个盒子，每个盒子里面有一个球，有等概率为黑球或者白球，每次打开一个盒子i需要花费$a_i$的代价。同时有一个操作可以告诉你剩下的所有盒子中有几个黑球，操作的代价为C。求如果要知道每个盒子中的球的颜色，所花费的最小代价</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>首先C最多只用花一次，且可以在最开始花，所以有两种策略：</p>
<p>a. 直接全部打开，代价：$\sum w_i$</p>
<p>b. 先排序。然后花C的代价，剩下的就相当于一个随机01序列从前往后开，开到一个后缀全是同色的为止。代价：$C+\sum w_i(1-\frac1{2^{n-i}})$​​</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> c, a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; c;</span><br><span class="line">    <span class="keyword">double</span> tmp = <span class="number">0</span>, tmp2 = c;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        tmp += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a, a + n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> two = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        tmp2 += a[i] * (<span class="number">1</span> - two);</span><br><span class="line">        two /= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.7lf\n"</span>, min(tmp, tmp2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Double-Strings"><a href="#Double-Strings" class="headerlink" title="Double Strings"></a><a href="https://ac.nowcoder.com/acm/contest/11256/D" target="_blank" rel="noopener">Double Strings</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给两个字符串A、B,求A、B中有多少个长度相等的子序列（可以不连续）满足a的字典序小于b。</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><strong>动态规划dp</strong></p>
<p>a小于b就等价于 一段相同的前缀 + a小于b的一个字母 + 一段长度相同的后缀</p>
<p>处理前缀</p>
<ol>
<li><p>状态定义：规定$dp[i][j]$​​表示 $a[0..i]$​​ 和 $b[0..j]$​ ​中相同的子序列的数量（字符串下标从1开始，下标为0代表字串为空）</p>
</li>
<li><p>状态转移：$$dp[i][j] = \begin{cases} dp[i-1][j]+dp[i][j-1]-dp[i-1][j-1] &amp; a[i] \neq b[i] \ dp[i-1][j]+dp[i][j-1] &amp; a[i]=b[j] \end{cases}$$</p>
</li>
</ol>
<p>处理后缀有两种方式，一种是可以以类似于处理前缀的方式处理</p>
<p>另一种是利用公式：$\sum_{i=0}^{min(x, y)} C_x^i *C_y^i = \sum_{i=0}^{min(x, y)} C_x^{x-i} *C_y^i = C_{x+y}^x$​，其中第二步到第三步可以理解为：从x+y个数里面随机取x个数​。</p>
<p>然后就是要注意，不能直接存C，会爆内存，需要预处理一下阶乘数和其逆元。然后用公式计算出C</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">5050</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> dp[N][N];</span><br><span class="line">ll fac[<span class="number">2</span> * N], rev[<span class="number">2</span> * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) (ret *= x) %= mod;</span><br><span class="line">        (x *= x) %= mod;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">2</span> * N; i++) &#123;</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rev[<span class="number">0</span>] = rev[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        rev[i] = qpow(fac[i], mod - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (fac[x] * rev[x - y]) % mod * rev[y] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">string</span> a, b;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    a = <span class="string">'0'</span> + a, b = <span class="string">'0'</span> + b;</span><br><span class="line">    <span class="keyword">int</span> n1 = a.length(), n2 = b.length();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n2; i++) dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n1; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n2; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] == b[j]) dp[i][j] = (dp[i - <span class="number">1</span>][j] + dp[i][j - <span class="number">1</span>]) % mod;</span><br><span class="line">            <span class="keyword">else</span> dp[i][j] = ((dp[i - <span class="number">1</span>][j] + dp[i][j - <span class="number">1</span>] - dp[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n1; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n2; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] &lt; b[j]) &#123;</span><br><span class="line">                (ans += ll(dp[i - <span class="number">1</span>][j - <span class="number">1</span>]) * C(n1 + n2 - i - j - <span class="number">2</span>, n1 - i - <span class="number">1</span>) % mod) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (ans + mod) % mod &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Jewels"><a href="#Jewels" class="headerlink" title="Jewels"></a><a href="https://ac.nowcoder.com/acm/contest/11256/J" target="_blank" rel="noopener">Jewels</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>一个三维平面里面有ｎ个宝石，宝石会以每秒 $v_i$​​​​ 的速度下落，所以时刻t宝石的位置为 $x_i, y_i, z_{0i}+tv_i$​​​​，你每秒钟可以以$x_i^2+y_i^2+z_i^2$的代价​​​​捞起一个宝石，求捞起所有宝石的最小代价。</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p><strong>二部图 最大权匹配(KM算法)</strong></p>
<p>每秒只能捞起一个宝石，因此宝石和时间其实是一个二部图的两个部分，其实就转化为了这个二部图的最小权匹配。但是一般是最大权匹配的模板，只要将其乘个-1就可以了。</p>
<p>套个板子其实代码很短。</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Data</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> inf = <span class="number">2e18</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, e[N + <span class="number">7</span>][N + <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//KM</span></span><br><span class="line"><span class="keyword">int</span> mb[N + <span class="number">7</span>], vb[N + <span class="number">7</span>], ka[N + <span class="number">7</span>], kb[N + <span class="number">7</span>], p[N + <span class="number">7</span>], c[N + <span class="number">7</span>];</span><br><span class="line"><span class="keyword">int</span> qf, qb, q[N + <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Bfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, v = <span class="number">0</span>, vl = <span class="number">0</span>, d;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) p[i] = <span class="number">0</span>, c[i] = inf;</span><br><span class="line">    mb[v] = u;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        a = mb[v], d = inf, vb[v] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">1</span>; b &lt;= n; b++)</span><br><span class="line">            <span class="keyword">if</span> (!vb[b]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (c[b] &gt; ka[a] + kb[b] - e[a][b])</span><br><span class="line">                    c[b] = ka[a] + kb[b] - e[a][b], p[b] = v;</span><br><span class="line">                <span class="keyword">if</span> (c[b] &lt; d) d = c[b], vl = b;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt;= n; b++)</span><br><span class="line">            <span class="keyword">if</span> (vb[b]) ka[mb[b]] -= d, kb[b] += d;</span><br><span class="line">            <span class="keyword">else</span> c[b] -= d;</span><br><span class="line">        v = vl;</span><br><span class="line">    &#125; <span class="keyword">while</span> (mb[v]);</span><br><span class="line">    <span class="keyword">while</span> (v) mb[v] = mb[p[v]], v = p[v];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">KM</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) mb[i] = ka[i] = kb[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">1</span>; a &lt;= n; a++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">1</span>; b &lt;= n; b++) vb[b] = <span class="number">0</span>;</span><br><span class="line">        Bfs(a);</span><br><span class="line">    &#125;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">1</span>; b &lt;= n; b++)</span><br><span class="line">        res += e[mb[b]][b];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// KM板子</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    m = n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">1</span>; a &lt;= n; a++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">1</span>; b &lt;= n; b++) e[a][b] = -inf;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z, v;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z &gt;&gt; v;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= n; t++) &#123;</span><br><span class="line">            e[i][t] = -(x * x + y * y + z * z);</span><br><span class="line">            z += v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, -KM());</span><br><span class="line"><span class="comment">//    for (int u = 1; u &lt;= n; u++) printf("%d ", mb[u]);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="King-of-Range"><a href="#King-of-Range" class="headerlink" title="King of Range"></a><a href="https://ac.nowcoder.com/acm/contest/11256/K" target="_blank" rel="noopener">King of Range</a></h1><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><p>给定数组$a$​​​, 对于每次查询给出$k$​，需要回答出数组中有多少个区间满足 $max-min &gt;= k$​​​</p>
<h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h3><ol>
<li><p><strong>ST表+双指针</strong></p>
<p>因为ST表可以做到$O(nlogn)$​​的预处理、$O(1)$​​​的查询。所以我们可以一种类似于双指针的做法去处理。</p>
<p>如果$[l_i, r_i]$​满足条件并且$[l_{i+1}, r_i]$​不满足条件，对于右端点$r_i$​来说，左端点可以从$[1, l_i]$​任取，此时其对答案的贡献为$l_i$</p>
<p>考虑右端点为$r_{i+1}$的情况，此时$[l_i,r_{r+i}]$一定也满足条件，但是此时$[l_{i+1}, r_{i+1}]$可能满足条件，因此我们需要再判断一下，可以使用ST表查询该区间的max和min，如果满足条件则左端点右移，不断查询直到左端点+1后不满足条件</p>
<p>由于此时l、r指针实际上都只会最多遍历数组一遍，因此查询的复杂度为$O(n)$，总的复杂度为$O(nlogn)$</p>
</li>
<li><p><strong>单调队列</strong><font style="opacity: 0">==todo==</font></p>
<p>其实和ST表一样，利用单调队列维护r指针前面出现的比他大k的最小数、比他小k的最大数。然后l不断向右移动。真的一样的其实</p>
</li>
</ol>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ST表</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> logn = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> fMin[N][logn + <span class="number">1</span>], fMax[N][<span class="number">20</span> + <span class="number">1</span>], Logn[N + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> a[N], n, q;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ST表 预处理</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Logn[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    Logn[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; N; i++) &#123;</span><br><span class="line">        Logn[i] = Logn[i / <span class="number">2</span>] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fMin[i][<span class="number">0</span>] = fMax[i][<span class="number">0</span>] = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= logn; j++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">            fMax[i][j] = max(fMax[i][j - <span class="number">1</span>], fMax[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            fMin[i][j] = min(fMin[i][j - <span class="number">1</span>], fMin[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getMax</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = Logn[y - x + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> max(fMax[x][s], fMax[y - (<span class="number">1</span> &lt;&lt; s) + <span class="number">1</span>][s]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = Logn[y - x + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> min(fMin[x][s], fMin[y - (<span class="number">1</span> &lt;&lt; s) + <span class="number">1</span>][s]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    pre();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k, p = <span class="number">0</span>;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>; r &lt;= n; r++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (p &lt; r &amp;&amp; getMax(p + <span class="number">1</span>, r) - a[r] &gt; k) p++;</span><br><span class="line">            <span class="keyword">while</span> (p &lt; r &amp;&amp; a[r] - getMin(p + <span class="number">1</span>, r) &gt; k) p++;</span><br><span class="line">            ans += p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单调队列</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">        <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; imin, imax;</span><br><span class="line"></span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; n; r++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!imin.empty() &amp;&amp; a[imin.back()] &gt; a[r]) imin.pop_back();</span><br><span class="line">            imin.push_back(r);</span><br><span class="line">            <span class="keyword">while</span> (!imax.empty() &amp;&amp; a[imax.back()] &lt; a[r]) imax.pop_back();</span><br><span class="line">            imax.push_back(r);</span><br><span class="line">            <span class="keyword">while</span> (!imin.empty() &amp;&amp; !imax.empty() &amp;&amp; a[imax.front()] - a[imin.front()] &gt; k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (imax.front() == l) imax.pop_front();</span><br><span class="line">                <span class="keyword">if</span> (imin.front() == l) imin.pop_front();</span><br><span class="line">                l++;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += r - l + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; n * (n + <span class="number">1</span>) / <span class="number">2</span> - ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A13/" class="post-title-link" itemprop="url">2021杭电多校3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-30 21:08:33" itemprop="dateCreated datePublished" datetime="2021-07-30T21:08:33+08:00">2021-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-03 03:11:17" itemprop="dateModified" datetime="2021-08-03T03:11:17+08:00">2021-08-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Forgiving-Matching"><a href="#Forgiving-Matching" class="headerlink" title="Forgiving Matching"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=6975" target="_blank" rel="noopener">Forgiving Matching</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>两个字符串 $S,\ T$​，分别长 $n,\ m$​ 仅包含数字和*，对于$0&lt;=k&lt;=m$​​，问在可以允许至多有 $k$ 位匹配不成功的情况下都多少种匹配方案</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ol>
<li><p>枚举0-9，使用FFT处理</p>
<p>如果不考虑通配符，我们可以依次枚举0-9，使用FFT处理出“只考虑这个数字的情况下，每个匹配点能够有几个匹配成功的地方”，那么最终对于这个匹配点而言，匹配成功的位数就是0-9之和。</p>
<p>使用FFT处理的方法是：将字符串转为字符串的多项式表达式，如果我们当前枚举到了x，那么所有等于x的位置赋为1，其他赋为0，对于S、T都这样处理之后之后再将T翻转，这时候如果S*T的某一位为$z(z \neq 0)$，则代表这位是匹配点时，数字x可以有z位匹配成功。</p>
</li>
<li><p>求出匹配数</p>
<p>对于每一个位置来说，如果已经有x个数字匹配成功了，那么如果再至少提供 $k(k + x=m)$ 次容错机会，就可以成功匹配了。</p>
<p>最后，如果考虑通配符的话，每个通配符都可以被看作是一次容错机会，但是如果有两个通配符对应上了，也只能看作是一次容错机会，这里对于通配符的处理其实和之前数字的处理是一致的</p>
<p>那么公式就变为了 $k = m - 数字匹配成功个数 + 容错符个数 - 容错符匹配成功个数$,这样算出来的k是恰好相等的情况，只要最后再跑一遍前缀和就可以了。</p>
</li>
</ol>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">//#pragma GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"><span class="comment">// 这份代码会T 别看了 我自己跑了遍数据 答案是对的</span></span><br><span class="line"><span class="comment">// 复杂度也是ok的啊 不知道为啥会T 🤫</span></span><br><span class="line"><span class="comment">// 明天(今天)再问问，自己实在是调不出来了 我要睡觉了了了</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">6e5</span> + <span class="number">1000</span>;</span><br><span class="line"><span class="comment">//const int maxn = 20;</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, k, sm;</span><br><span class="line"><span class="keyword">int</span> tax[maxn];</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; F[<span class="number">11</span>][maxn], G[<span class="number">11</span>][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; *A, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">        <span class="keyword">if</span> (tax[i] &gt; i) &#123;</span><br><span class="line">            <span class="built_in">std</span>::swap(A[i], A[tax[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>, M = <span class="number">1</span>; len &lt;= N; M = len, len &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        std::complex&lt;double&gt; W(cos(PI / M), sin(PI / M)), w(1.0, 0.0);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> L = <span class="number">0</span>, R = len - <span class="number">1</span>; R &lt;= N; L += len, R += len) &#123;</span><br><span class="line">            <span class="keyword">auto</span> w0 = w;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> p = L, lim = L + M; p &lt; lim; ++p) &#123;</span><br><span class="line">                <span class="keyword">auto</span> x = A[p] + w0 * A[p + M], y = A[p] - w0 * A[p + M];</span><br><span class="line">                A[p] = x;</span><br><span class="line">                A[p + M] = y;</span><br><span class="line">                w0 *= W;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MakeRev</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = N &gt;&gt; <span class="number">1</span>, p = <span class="number">0</span>;</span><br><span class="line">    tax[p++] = <span class="number">0</span>;</span><br><span class="line">    tax[p++] = d;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">2</span>; w &lt;= N; w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        d &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p0 = <span class="number">0</span>; p0 &lt; w; ++p0) &#123;</span><br><span class="line">            tax[p++] = tax[p0] | d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sm = n + m + <span class="number">2</span>;</span><br><span class="line">    k = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k &lt;= sm) k &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    MakeRev(k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line"><span class="keyword">int</span> pre[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) ans[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) pre[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k + <span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">11</span>; j++)</span><br><span class="line">            F[j][i] = G[j][i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">string</span> s, t;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s &gt;&gt; t;</span><br><span class="line">    reverse(t.begin(), t.end());</span><br><span class="line"><span class="comment">//    s = '0' + s, t = '0' + t;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'*'</span>) F[<span class="number">10</span>][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> F[s[i] - <span class="string">'0'</span>][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (t[i] == <span class="string">'*'</span>) G[<span class="number">10</span>][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> G[t[i] - <span class="string">'0'</span>][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">        FFT(F[i], k);</span><br><span class="line">        FFT(G[i], k);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; ++j) &#123;</span><br><span class="line">            F[i][j] *= G[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        FFT(F[i], k);</span><br><span class="line">        <span class="built_in">std</span>::reverse(F[i] + <span class="number">1</span>, F[i] + k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= sm; ++j) &#123;</span><br><span class="line">            F[i][j] = <span class="keyword">int</span>((F[i][j].real()) / k + <span class="number">0.5</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// pre从1开始...</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        pre[i] = pre[i - <span class="number">1</span>] + (s[i - <span class="number">1</span>] == <span class="string">'*'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tStar = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        tStar += (t[i] == <span class="string">'*'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m - <span class="number">1</span>; i &lt; n; i++) &#123; <span class="comment">// 对于每一个「匹配点」</span></span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">9</span>; j++) &#123;</span><br><span class="line">            sum += <span class="keyword">int</span>(F[j][i].real());</span><br><span class="line">        &#125;</span><br><span class="line">        ans[m - (sum + tStar + pre[i + <span class="number">1</span>] - pre[i - m + <span class="number">1</span>] - <span class="keyword">int</span>(F[<span class="number">10</span>][i].real()))]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) ans[i] += ans[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Photoshop-Layers"><a href="#Photoshop-Layers" class="headerlink" title="Photoshop Layers"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=6979" target="_blank" rel="noopener">Photoshop Layers</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>有n个ps图层，图层分为两种，一种会覆盖掉之前的图层，只显示自己，另外一种会将自己的rgb和前面的叠加后一起显示。对于每次询问[l, r]，求出这个区间的图层叠加后最终显示效果。</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>如果只有第二种图层，用前缀和处理一下就可以了，但是对于第一种图层，我们可以用一个数组标记当前位置前出现的最后一个第一种图层x，最后在查询的时候，如果区间[l, r]包含了x，那么就相当于查询[x, r]</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> mode, r, g, b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">node a[N], pre[N];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; to10;</span><br><span class="line"><span class="keyword">char</span> to16[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)to10[i + <span class="string">'0'</span>] = i, to16[i] = i + <span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)to10[i + <span class="string">'A'</span>] = i + <span class="number">10</span>, to16[i + <span class="number">10</span>] = i + <span class="string">'A'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> preMode1[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="built_in">string</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i].mode &gt;&gt; tmp;</span><br><span class="line">        a[i].r = to10[tmp[<span class="number">0</span>]] * <span class="number">16</span> + to10[tmp[<span class="number">1</span>]];</span><br><span class="line">        a[i].g = to10[tmp[<span class="number">2</span>]] * <span class="number">16</span> + to10[tmp[<span class="number">3</span>]];</span><br><span class="line">        a[i].b = to10[tmp[<span class="number">4</span>]] * <span class="number">16</span> + to10[tmp[<span class="number">5</span>]];</span><br><span class="line">        preMode1[i] = (a[i].mode == <span class="number">1</span> ? i : preMode1[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        pre[i].r = a[i].r + pre[i - <span class="number">1</span>].r;</span><br><span class="line">        pre[i].g = a[i].g + pre[i - <span class="number">1</span>].g;</span><br><span class="line">        pre[i].b = a[i].b + pre[i - <span class="number">1</span>].b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> l, r;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        l = max(l, preMode1[r]);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; to16[min(pre[r].r - pre[l - <span class="number">1</span>].r, <span class="number">255</span>) / <span class="number">16</span>] &lt;&lt; to16[min(pre[r].r - pre[l - <span class="number">1</span>].r, <span class="number">255</span>) % <span class="number">16</span>];</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; to16[min(pre[r].g - pre[l - <span class="number">1</span>].g, <span class="number">255</span>) / <span class="number">16</span>] &lt;&lt; to16[min(pre[r].g - pre[l - <span class="number">1</span>].g, <span class="number">255</span>) % <span class="number">16</span>];</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; to16[min(pre[r].b - pre[l - <span class="number">1</span>].b, <span class="number">255</span>) / <span class="number">16</span>] &lt;&lt; to16[min(pre[r].b - pre[l - <span class="number">1</span>].b, <span class="number">255</span>) % <span class="number">16</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Rise-in-Price"><a href="#Rise-in-Price" class="headerlink" title="Rise in Price"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=6981" target="_blank" rel="noopener">Rise in Price</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>有一个n*n的矩形，只能向右/向下移动。每次移动你的宝石数量会增加$w_{i, j}$，宝石价值会增加$p_{i, j}$，求最后到达终点后最多有多少钱。</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>对于每一个点维护一个vector，保存着到达这个点能取到的{数量, 价值}，如果有一个状态的数量和价值都小于另一个状态，那就将其舍弃。</p>
<p>主要就是注意，状态在转移的时候，要用类似于归并排序的一种做法，不然会T</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="comment">//typedef pair&lt;int, int&gt; pp;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pp</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> f, s;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> pp &amp;p1) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !(f &gt;= p1.f &amp;&amp; s &gt;= p1.s || f &lt;= p1.f &amp;&amp; s &lt;= p1.s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pp <span class="keyword">operator</span>+(<span class="keyword">const</span> pp &amp;p1) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;f + p1.f, s + p1.s&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;pp&gt; <span class="title">merge</span><span class="params">(<span class="built_in">vector</span>&lt;pp&gt; p1, <span class="built_in">vector</span>&lt;pp&gt; p2, pp x)</span> </span>&#123;</span><br><span class="line">    vector&lt;pp&gt; ppp1(p1), ppp2(p2);</span><br><span class="line">    <span class="built_in">vector</span>&lt;pp&gt; ret;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> sz1 = p1.size(), sz2 = p2.size();</span><br><span class="line">    <span class="keyword">int</span> maxS = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; sz1 || j &lt; sz2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i&lt;sz1 &amp;&amp;( j == sz2 || p1[i].f &gt; p2[j].f)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p1[i].s &gt; maxS) &#123;</span><br><span class="line">                maxS = p1[i].s;</span><br><span class="line">                ret.push_back(p1[i] + x);</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (p2[j].s &gt; maxS) &#123;</span><br><span class="line">                maxS = p2[j].s;</span><br><span class="line">                ret.push_back(p2[j] + x);</span><br><span class="line">            &#125;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pp a[N][N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pp&gt; dp[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; a[i][j].f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; a[i][j].s;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) dp[i][j].clear();</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">1</span>][<span class="number">1</span>].push_back(a[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">1</span>].push_back(dp[i - <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] + a[i][<span class="number">1</span>]);</span><br><span class="line">        dp[<span class="number">1</span>][i].push_back(dp[<span class="number">1</span>][i - <span class="number">1</span>][<span class="number">0</span>] + a[<span class="number">1</span>][i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            dp[i][j] = merge(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>], a[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> x: dp[n][n]) ans = max(ans, ll(x.f) * x.s);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A14/" class="post-title-link" itemprop="url">2021牛客多校4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-28 14:05:38" itemprop="dateCreated datePublished" datetime="2021-07-28T14:05:38+08:00">2021-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-02 20:23:39" itemprop="dateModified" datetime="2021-08-02T20:23:39+08:00">2021-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Sample-Game"><a href="#Sample-Game" class="headerlink" title="Sample Game"></a><a href="https://ac.nowcoder.com/acm/contest/11255/B" target="_blank" rel="noopener">Sample Game</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给定[1, n]中每个数的概率，每次可以以 $p_i$ 的概率选择i，如果i大于等于之前选择的所有数，则继续选择，否则答案等于当前选择的数的长度平方$len^2$。求答案的期望。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p><strong>生成函数</strong><a href="https://oi-wiki.org/math/gen-func/intro/" target="_blank" rel="noopener">https://oi-wiki.org/math/gen-func/intro/</a></p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gsycp8yiz1j31lr0lqwj5.jpg" alt="image-20210730015030424"></p>
<p>（我有罪，当时在勾补题的时候看这题的解析，看就一个公式，应该不会很复杂吧，但是没想到还要用生成函数，而且…中间证明我也看不懂…属于是无效补题了…20级的同学就当学学怎么求逆元吧，19级同学就见识一下世界的广阔和我的弱智吧🌞）</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) (ret *= x) %= mod;</span><br><span class="line">        (x *= x) %= mod;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">one_</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="comment">// 求 1/x</span></span><br><span class="line">    <span class="keyword">return</span> qpow(x, mod - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll n, p[N], sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; p[i];</span><br><span class="line">        sum += p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sum = one_(sum);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        (p[i] *= sum) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ll F_1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        (F_1 *= <span class="number">1</span> * one_(<span class="number">1</span> - p[i])) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ll F_1_ = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        (F_1_ += (p[i] * one_(<span class="number">1</span> - p[i]))) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    (((F_1_ *= <span class="number">2</span>) %= mod) *= F_1) %= mod;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ((F_1_ + F_1) % mod + mod) % mod &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Tree-Xor"><a href="#Tree-Xor" class="headerlink" title="Tree Xor"></a><a href="https://ac.nowcoder.com/acm/contest/11255/E" target="_blank" rel="noopener">Tree Xor</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给一棵树，已知树上每一个点的 $w_i$​​ 一定落在 $[l_i, r_i]$​​ 中，并且已知每条边 $(u, v)$​​ 的值 $x$，有 $w_u \oplus w_v = x$​​​​。求这棵树有多少种可能性</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><strong>01字典树</strong></p>
<p>首先根据异或的性质，用一个DFS可以求到每一个点到初始点(假设是1号点)的异或值x，那么答案就是 每一个区间异或上x所形成的区间的交集。</p>
<p>「01字典树通常用来处理异或的问题」，我们可以设计一个这样的01字典树，每次可以修改一个区间异或上一个值所形成的区间。可以利用一个类似于线段树的lazy标签处理。</p>
<p>剩下的就看注释吧</p>
<p>==REDO</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------------------------</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">31</span>; <span class="comment">// 最大位数</span></span><br><span class="line"><span class="keyword">int</span> tol = <span class="number">1</span>; <span class="comment">// 节点个数</span></span><br><span class="line"><span class="keyword">int</span> val[<span class="number">32</span> * N * <span class="number">4</span>]; <span class="comment">// 点的权值</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">32</span> * N * <span class="number">4</span>][<span class="number">2</span>]; <span class="comment">// 左右孩子的位置</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123; <span class="comment">// 类似线段树lazy</span></span><br><span class="line">    val[ch[u][<span class="number">0</span>]] += val[u];</span><br><span class="line">    val[ch[u][<span class="number">1</span>]] += val[u];</span><br><span class="line">    val[u] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> w, <span class="keyword">int</span> x)</span> </span>&#123; <span class="comment">// 将 [0, R]^w 所形成的区间 += x</span></span><br><span class="line">    <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (r &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> R = (r &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> W = (w &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!ch[u][<span class="number">0</span>]) &#123; <span class="comment">//如果当前节点的子未被访问过</span></span><br><span class="line">            ch[u][<span class="number">0</span>] = tol++;</span><br><span class="line">            ch[u][<span class="number">1</span>] = tol++;</span><br><span class="line">            pushdown(u);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (R) &#123; <span class="comment">// 如果R是1，假设w是0，答案区间这位取0，和w异或值为0，一定小于R</span></span><br><span class="line">          <span class="comment">// 也就是说 R ^ W ^ 1 对应的子树异或后一定都会小于r          </span></span><br><span class="line">            val[ch[u][R ^ W ^ <span class="number">1</span>]] += x;</span><br><span class="line">        &#125;</span><br><span class="line">        u = ch[u][R ^ W];</span><br><span class="line">    &#125;</span><br><span class="line">    val[u] += x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> i)</span> </span>&#123; <span class="comment">// 找[1, n]中点权为n的节点数</span></span><br><span class="line">    <span class="keyword">if</span> (ch[u][<span class="number">0</span>]) &#123;</span><br><span class="line">        pushdown(u);</span><br><span class="line">        <span class="keyword">return</span> query(ch[u][<span class="number">0</span>], i - <span class="number">1</span>) + query(ch[u][<span class="number">1</span>], i - <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val[u] == n) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>); <span class="comment">// 终点</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pp;</span><br><span class="line">pp interval[N];</span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pp&gt; e[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k: e[x]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = k.first;</span><br><span class="line">        <span class="keyword">if</span> (vis[y]) <span class="keyword">continue</span>;</span><br><span class="line">        w[y] = w[x] ^ k.second;</span><br><span class="line">        dfs(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; interval[i].first &gt;&gt; interval[i].second;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">        e[x].push_back(&#123;y, z&#125;);</span><br><span class="line">        e[y].push_back(&#123;x, z&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        add(interval[i].second, w[i], <span class="number">1</span>);</span><br><span class="line">        add(interval[i].first - <span class="number">1</span>, w[i], <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; query(<span class="number">0</span>, M) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Inverse-Pair"><a href="#Inverse-Pair" class="headerlink" title="Inverse Pair"></a><a href="https://ac.nowcoder.com/acm/contest/11255/I" target="_blank" rel="noopener">Inverse Pair</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>给定一个排列，可以对任意数字+1（每个数字最多加一次），问逆序对数量最少为</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>先用<strong>树状数组 or 归并排序</strong>求出原始数组逆序对数量</p>
<p>考虑：每次都每个数字x加一后，只有当x+1在x的前面时，逆序对的数量才会少一，因此用一个vis表示前面有没有出现过x+1就可以了。主要就是求逆序对</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> tree[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lb</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; (-x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>&#123; <span class="comment">// pos位置 + x</span></span><br><span class="line">    <span class="keyword">while</span> (pos &lt;= n) &#123;</span><br><span class="line">        tree[pos] += x;</span><br><span class="line">        pos += lb(pos);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// [1, r] 和</span></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (r &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        cnt += tree[r];</span><br><span class="line">        r -= lb(r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        ans += i - query(a[i]);</span><br><span class="line">        insert(a[i], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> &amp;x = a[i];</span><br><span class="line">        <span class="keyword">if</span> (vis[x + <span class="number">1</span>]) ans--;</span><br><span class="line">        <span class="keyword">else</span> vis[x] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Average"><a href="#Average" class="headerlink" title="Average"></a><a href="https://ac.nowcoder.com/acm/contest/11255/J" target="_blank" rel="noopener">Average</a></h1><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><p>求数组中区间长度不小于L的最大平均值</p>
<h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h3><p><strong>二分答案</strong>，假设当前平均时为x看可行不可行。判断时用前缀和判断，将每个数都减去x，看存不存在一个长度大于L的区间和为非负数</p>
<p>==REDO==</p>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findMax</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;sum, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">pre</span><span class="params">(n + <span class="number">1</span>)</span></span>; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) pre[i] = pre[i - <span class="number">1</span>] + sum[i - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span> (l + <span class="number">1e-7</span> &lt; r) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> preMin = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &lt;= n; i++) &#123; <span class="comment">// 枚举右端点</span></span><br><span class="line">            <span class="keyword">if</span> (pre[i] - mid * i - preMin &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                ok = <span class="number">1</span>;</span><br><span class="line">                l = mid;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            preMin = min(preMin, pre[i - m + <span class="number">1</span>] - mid * (i - m + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ok) r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, x, y;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    vector&lt;int&gt; a(n), b(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.8lf\n"</span>, findMax(a, n, x) + findMax(b, m, y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zhang185a.gitee.io/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/header.jpeg">
      <meta itemprop="name" content="zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang185's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A13/" class="post-title-link" itemprop="url">2021牛客多校3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-28 14:05:23" itemprop="dateCreated datePublished" datetime="2021-07-28T14:05:23+08:00">2021-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-30 04:29:12" itemprop="dateModified" datetime="2021-07-30T04:29:12+08:00">2021-07-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Black-and-white"><a href="#Black-and-white" class="headerlink" title="Black and white"></a><a href="https://ac.nowcoder.com/acm/contest/11254/B" target="_blank" rel="noopener">Black and white</a></h1><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>$n*m$的矩形 初始时每个点都为白色，可以以$C_{i, j}$的代价将点$(i, j)$染黑，并且如果任取两行两列交叉的四个格子中有三个是黑色，则第四个格子可以免费染黑。问将所有格子染黑的最小代价。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p><strong>最小生成树</strong>，实在是太妙了…</p>
<p>将图的每一行和每一列抽象成二部图的点，每个格子的代价可以看作是这个二部图两个点连线形成的代价.如果可以免费地连接两个点，此时整个图形的连通性不会发生改变。因此最后全部连通即等于初始连通时的答案。使用最小生成树求解。</p>
<p>答案说用prime算法，但是我看好多人都用的是Kruskal。 </p>
<p>==REDO==</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line">ll n, m, b, c, d, p;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> A[N * N];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">2</span> * N][<span class="number">2</span> * N];</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">2</span> * N];</span><br><span class="line"><span class="keyword">int</span> curMin[<span class="number">2</span> * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(curMin, <span class="number">0x33</span>, <span class="keyword">sizeof</span>(curMin));</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; A[<span class="number">0</span>] &gt;&gt; b &gt;&gt; c &gt;&gt; d &gt;&gt; p;</span><br><span class="line"><span class="comment">//    see(curMin[1]);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            ll pre = A[m * (i - <span class="number">1</span>) + j - <span class="number">1</span>];</span><br><span class="line">            A[m * (i - <span class="number">1</span>) + j] = ((pre * pre % p * b % p + pre * c % p) % p + d) % p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            a[i][j + N] = A[m * (i - <span class="number">1</span>) + j];</span><br><span class="line">            a[j + N][i] = A[m * (i - <span class="number">1</span>) + j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;, greater&lt;&gt; &gt; pq; <span class="comment">// 权 点</span></span><br><span class="line">    pq.push(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!pq.empty()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> cur = pq.top();</span><br><span class="line">        pq.pop();</span><br><span class="line">        <span class="keyword">if</span> (vis[cur.second]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[cur.second] = <span class="number">1</span>;</span><br><span class="line">        ans += cur.first;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cur.second &lt;= N) &#123; <span class="comment">// 当前是i</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!vis[i + N] &amp;&amp; a[cur.second][i + N] &lt; curMin[i + N]) &#123;</span><br><span class="line">                    pq.push(&#123;a[cur.second][i + N], i + N&#125;);</span><br><span class="line">                    curMin[i + N] = a[cur.second][i + N];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!vis[i] &amp;&amp; a[cur.second][i] &lt; curMin[i]) &#123;</span><br><span class="line">                    pq.push(&#123;a[cur.second][i], i&#125;);</span><br><span class="line">                    curMin[i] = a[cur.second][i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Minimum-grid"><a href="#Minimum-grid" class="headerlink" title="Minimum grid"></a><a href="https://ac.nowcoder.com/acm/contest/11254/C" target="_blank" rel="noopener">Minimum grid</a></h1><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>给定一个 $n*m$ 的矩形以每行、每列的最大值，但是有的地方无法填值，求如何填值可以使得矩形各点之和最小</p>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>转成二部图的<strong>最大匹配问题</strong></p>
<p>枚举各边能取到的最大值x，如果有一个点的行最大和列最大都是x，那么在这里填入x后可以同时满足这行和这列，假设有n行m列的最大值要求为x，并且我们能在k个交叉点填入x，那么对于x而已，花费就是 $(n+m-k)x$​ 之后枚举每一个可能取到的最大值即可。</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> N = <span class="number">2e3</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k, a[N], b[N], c[<span class="number">2</span> * N], con[N][N];</span><br><span class="line"><span class="keyword">int</span> cy[N];</span><br><span class="line"><span class="keyword">bool</span> cx[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">line</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> x)</span> </span>&#123; <span class="comment">//尝试给x[u] 连线</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v &lt;= n; v++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (con[u][v] == x &amp;&amp; !vis[v] &amp;&amp; b[v] == x) &#123;</span><br><span class="line">            vis[v] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cy[v] || line(cy[v], x)) &#123;<span class="comment">//如果y集合中的v没有匹配或v已经匹配，但从cy[v]中可以找到一条增广路</span></span><br><span class="line">                cx[u] = <span class="number">1</span>;</span><br><span class="line">                cy[v] = u;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxmatch</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="comment">// vis&gt;=x才视作有边相连</span></span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] != x) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) vis[j] = <span class="number">0</span>;</span><br><span class="line">        sum += line(i, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        c[i] = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line">        c[i + n] = b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> i, j;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; i &gt;&gt; j;</span><br><span class="line">        con[i][j] = min(a[i], b[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(c + <span class="number">1</span>, c + <span class="number">2</span> * n + <span class="number">1</span>, greater&lt;&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">2</span> * n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c[i] != c[i - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cx[i] = cy[i] = <span class="number">0</span>;</span><br><span class="line">            ans += c[i - <span class="number">1</span>] * (cnt - maxmatch(c[i - <span class="number">1</span>]));</span><br><span class="line">            cnt = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Math"><a href="#Math" class="headerlink" title="Math"></a><a href="https://ac.nowcoder.com/acm/contest/11254/E" target="_blank" rel="noopener">Math</a></h1><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>有 $1&lt;=x&lt;=y&lt;=n$,求满足 $(x^2+y^2) mod (xy+1) = 0$ 的 (x,y) 的对数。</p>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>两个方法，法一应该才是正解😇</p>
<ol>
<li>打表，打表观察后得到答案</li>
<li><img src="https://tva1.sinaimg.cn/large/008i3skNly1gsyh31ytigj315d0u0gr8.jpg" alt="image-20210730042215951">)(我看不懂，但我大受震惊.jpg)</li>
</ol>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> __int128 ll;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// x &lt;= y</span></span><br><span class="line">    ans.push_back(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt; <span class="number">1e6</span> + <span class="number">10</span>; i++) &#123;</span><br><span class="line">        ll x = i, y = i * i * i, k = i * i;</span><br><span class="line">        <span class="keyword">while</span> (y &lt;= <span class="number">1e18</span>) &#123;</span><br><span class="line">            ans.push_back(y);</span><br><span class="line">            swap(x, y);</span><br><span class="line">            y = k * x - y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ans.begin(), ans.end());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> x;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; upper_bound(ans.begin(), ans.end(), x) - ans.begin() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="24dian"><a href="#24dian" class="headerlink" title="24dian"></a><a href="https://ac.nowcoder.com/acm/contest/11254/F" target="_blank" rel="noopener">24dian</a></h1><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><p>24点游戏：可以从1-13中选择n张牌（每张牌可以选多次），问有多少种牌的组合使得可以通过加减乘除得到t并且过程中一定会出现分数</p>
<h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h3><p>模拟、DFS。模拟模疯了😇。</p>
<p>得到的一个经验就是这种很折磨人的大模拟题就用vector当参数传就是了，不要维护一个全局变量，又要改又要改回去，麻烦麻烦</p>
<p>==REDO==</p>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">'\n'</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> see(...) cerr &lt;&lt; <span class="meta-string">"("</span> &lt;&lt; #__VA_ARGS__ &lt;&lt; <span class="meta-string">"):"</span>, _out(__VA_ARGS__)</span></span><br><span class="line"><span class="comment">//#define int ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _out() &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> H, <span class="keyword">typename</span>... T&gt;</span><br><span class="line"><span class="keyword">void</span> _out(H h, T... t) &#123;</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; h;</span><br><span class="line">    _out(t...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ZZY_DEBUG_LEVEL</span></span><br><span class="line">    freopen(<span class="string">"abc.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, t;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">4</span>)</span></span>;</span><br><span class="line"><span class="comment">//vector&lt;double&gt; res;</span></span><br><span class="line"><span class="comment">//map&lt;vector&lt;int&gt;, bool&gt; show; //出现了不是分数吗</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; (<span class="keyword">int</span>) x + <span class="number">1e-9</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (y &gt; (<span class="keyword">int</span>) y + <span class="number">1e-9</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x / y &gt; (<span class="keyword">int</span>) (x / y) + <span class="number">1e-9</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; res, <span class="keyword">bool</span> hasFenShu)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 0 -&gt; 失败 1-&gt;成功且分数 2-&gt; 成功但可以没分数</span></span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">A</span><span class="params">(res)</span></span>;</span><br><span class="line">    <span class="keyword">int</span> flg = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> sz = res.size();</span><br><span class="line">    <span class="keyword">if</span> (sz == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="comment">//        cout&lt;&lt;res[0]&lt;&lt;endl;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span>(res[<span class="number">0</span>] - t) &lt; <span class="number">1e-6</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hasFenShu) &#123;</span><br><span class="line"><span class="comment">//                show[a] = 1;</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz; j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; sz; k++) &#123;<span class="comment">//选两个数操作</span></span><br><span class="line">            <span class="keyword">if</span> (j == k) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; tmp;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">                <span class="keyword">if</span> (i != j &amp;&amp; i != k) tmp.push_back(res[i]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            tmp.push_back(res[j] + res[k]);</span><br><span class="line">            flg = max(flg, dfs(tmp, hasFenShu));</span><br><span class="line">            tmp.pop_back();</span><br><span class="line"></span><br><span class="line">            tmp.push_back(res[j] - res[k]);</span><br><span class="line">            flg = max(flg, dfs(tmp, hasFenShu));</span><br><span class="line">            tmp.pop_back();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            tmp.push_back(res[j] * res[k]);</span><br><span class="line">            flg = max(flg, dfs(tmp, hasFenShu));</span><br><span class="line">            tmp.pop_back();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(res[k]) &gt; <span class="number">1e-6</span>) &#123;</span><br><span class="line">                tmp.push_back(res[j] / res[k]);</span><br><span class="line"><span class="comment">//                if (judge(res[j], res[k]))</span></span><br><span class="line"><span class="comment">//                    see(1);</span></span><br><span class="line">                flg = max(flg, dfs(tmp, hasFenShu || judge(res[j], res[k])));</span><br><span class="line">                tmp.pop_back();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; t;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    if (dfs(&#123;1, 3, 4, 6&#125;, 0) == 1) ans.push_back(a);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">13</span>; i++) &#123;</span><br><span class="line">        res.push_back(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= (n &gt;= <span class="number">2</span> ? <span class="number">13</span> : i); j++) &#123;</span><br><span class="line">            res.push_back(j);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt;= (n &gt;= <span class="number">3</span> ? <span class="number">13</span> : j); k++) &#123;</span><br><span class="line">                res.push_back(k);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> l = k; l &lt;= (n &gt;= <span class="number">4</span> ? <span class="number">13</span> : k); l++) &#123;</span><br><span class="line">                    res.push_back(l);</span><br><span class="line">                    a[<span class="number">0</span>] = i, a[<span class="number">1</span>] = j, a[<span class="number">2</span>] = k, a[<span class="number">3</span>] = l;</span><br><span class="line">                    <span class="keyword">while</span> (res.size() &gt; n) res.pop_back();</span><br><span class="line">                    <span class="keyword">if</span> (dfs(res, <span class="number">0</span>) == <span class="number">1</span>) ans.push_back(a);</span><br><span class="line">                    <span class="keyword">if</span>(res.size() == <span class="number">4</span>) res.pop_back();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(res.size() == <span class="number">3</span>) res.pop_back();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(res.size() == <span class="number">2</span>) res.pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(res.size() == <span class="number">1</span>) res.pop_back();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans.size()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> x: ans) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; x[i] &lt;&lt; <span class="string">" \n"</span>[i == n - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/blog/">1</a><span class="page-number current">2</span><a class="page-number" href="/blog/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/7/">7</a><a class="extend next" rel="next" href="/blog/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhang"
      src="/blog/images/header.jpeg">
  <p class="site-author-name" itemprop="name">zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">65</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">X</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  















  

  

</body>
</html>
